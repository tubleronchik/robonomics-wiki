{"hash":"2f6248998483832cb1c161bc8dcd33dd4cc8bb3f","data":{"doc":{"id":"0bf960bccd15014e02fe06ab775ff988","title":"Connect Mars Curiosity rover under Robonomics parachain control","contributors":["Vourhey","PaTara43"],"translated":false,"headings":[],"subtitles":[{"depth":2,"value":"1. Set up a simulation","anchor":"#1-set-up-a-simulation"},{"depth":2,"value":"2. Download controller package","anchor":"#2-download-controller-package"},{"depth":2,"value":"3. Manage accounts in DAPP","anchor":"#3-manage-accounts-in-dapp"},{"depth":2,"value":"4. Start Robonomics","anchor":"#4-start-robonomics"},{"depth":2,"value":"Troubleshooting","anchor":"#troubleshooting"}],"content":"\n**Let's see how Robonomics Parachain control allows to make Mars Curiosity rover move. Requirements:**\n- Ubuntu 18.04 LTS\n- ROS Melodic + Gazebo + RViz (installation manual [here](http://wiki.ros.org/melodic/Installation))\n- extra packages:\n```shell\nsudo apt-get install ros-melodic-gazebo-ros-control ros-melodic-effort-controllers ros-melodic-joint-state-controller\n```\n- IPFS 0.4.22 (download from [here](https://dist.ipfs.io/go-ipfs/v0.4.22/go-ipfs_v0.4.22_linux-386.tar.gz) and install)\n- Python dependencies:\n```\npip install ipfshttpclient\n```\n- Robonomics node (binary file) (download latest release [here](https://github.com/airalab/robonomics/releases))\n- IPFS browser extension (optional)\n\nHere is the video showing successful launch:\n\nhttps://youtu.be/pl3eIEC_T2o\n\n## 1. Set up a simulation\nDownload Curiosity rover package:\n```\nmkdir -p robonomics_ws/src\ncd robonomics_ws/src\ngit clone https://bitbucket.org/theconstructcore/curiosity_mars_rover/src/master/\ncd ..\n```\nWe need to adjust starting conditions to make our rover spawn smoothly:\n- Go to\n\n`/robonomics_ws/src/master/curiosity_mars_rover_description/worlds` and change line 14 of the file` mars_curiosity.world` to\n`<pose>0 0 9 0 0 0</pose>`.\n\n- Go to\n\n`/robonomics_ws/src/master/curiosity_mars_rover_description/launch` and change line 4 of the file `mars_curiosity_world.launch` to\n`<arg name=\"paused\" default=\"false\"/>`.\n\nDon’t forget to add source command to `~/.bashrc`:\n```\necho \"source /home/$USER/robonomics_ws/devel/setup.bash\" >> ~/.bashrc\n```\n\n## 2. Download controller package\nIn terminal do the following. This will download a sample script used in the demo:\n```\ncd ~/robonomics_ws/src\ngit clone https://github.com/PaTara43/robonomics_sample_controller\ncd ../..\ncatkin build\n```\n\n## 3. Manage accounts in DAPP\nSince we are testing, let's create a local robonomics network node with robonomics binary file:\n```\n./robonomics --dev --rpc-cors all\n```\n**Important!** Before next launches it is necessary to remove a directory `db` with\n\n```\nrm -rf /home/$USER/.local/share/robonomics/chains/dev/db\n```\n\nAfter a successful launch create accounts for the rover and for it's employer following [this](/docs/create-account-in-dapp) manual. **Do not forget to save each account's seed (RAW SEED) and address! You will need them for transactions**. Add these addresses, seeds and path to robonomics binary file to file `config.config` in `robonomics_ws/src/robonomics_sample_controller/src`. Transfer some money (units) to these accounts:\n\n![Config](../images/curiosity-demo/config.jpg \"Config\")\n\n![Balances](../images/curiosity-demo/balances.jpg \"Balances\")\n\n## 4. Start Robonomics\nUp to now the **only thing running** should be the robonomics local node.\nIn a separate terminal launch IPFS:\n```\nipfs init # you only need to do this once\nipfs daemon\n```\nIn another separate terminal launch Curiosity simulation:\n```\nroslaunch curiosity_mars_rover_description main_real_mars.launch\n```\nWait till it stays still and after that in another terminal launch the controller:\n```\nrosrun robonomics_sample_controller sample_controller.py\n```\n\n![Curiosity](../images/curiosity-demo/curiosity.jpg \"Curiosity\")\n\nNow you can send a transaction triggering the Rover to start moving and collecting data. To do so, you should use the [Robonomics IO](https://wiki.robonomics.network/docs/rio-overview/)  `write` subcommand of robonomics binary file:\n```\necho \"ON\" | ./robonomics io write launch -r <CURIOSITY ADDRESS> -s <EMPLOYER’S KEY>\n```\nWhere `<CURIOSITY ADDRESS>`  and `<EMPLOYER’S KEY>` are replaced with  previously saved strings accordingly.\nYou should see the log `\"Arming...\"` and the robot should start moving its camera and arm. Later, when the job is done (there is a log informing user when the program has finished), on the Robonomics portal go to `Developer` -> `Chain state` and add a CURIOSITY datalog using `“+”` button with selected `datalog` as state query:\n\n![Datalog](../images/curiosity-demo/hash_in_chain.jpg \"Datalog\")\n\nThe IPFS hash of the telemetry has been saved in the blockchain. To see the data simply copy the hash and add it to the local [gateway](https://gateway.ipfs.io/ipfs/QmeYYwD4y4DgVVdAzhT7wW5vrvmbKPQj8wcV2pAzjbj886/docs/getting-started/) address `localhost:8080/ipfs/`:\n\n![Voila](../images/curiosity-demo/datalog.jpg \"Voila\")\n\n## Troubleshooting\n\nIf due to some reason addresses in IO module and on the portal are displayed unequally (e.g. `5...` and `4...`) and the program outputs \"Not my job is paid\", fill in configuration file with address of the same type as in IO module.\n"}},"context":{}}